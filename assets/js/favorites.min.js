var Favorites=Favorites||{};function favorites_after_button_submit(t,e,o,a){}function favorites_after_initial_load(t){}Favorites.Utilities=function(){var t=this,e=jQuery;t.isFavorite=function(o,t){var a=!1;return e.each(t,function(t,e){e.post_id===parseInt(o)&&(a=!0),parseInt(e.post_id)===o&&(a=!0)}),a},t.objectLength=function(t){var e,o=0;for(e in t)t.hasOwnProperty(e)&&o++;return o},t.siteIndex=function(t){for(var e=0;e<Favorites.userFavorites.length;e++)if(Favorites.userFavorites[e].site_id===parseInt(t))return e},t.getThumbnail=function(t,e){t=t.thumbnails;if(void 0===t||0==t.length)return!1;e=t[e];return void 0!==e&&e||!1}},(Favorites=Favorites||{}).Formatter=function(){var i=jQuery;this.addFavoriteCount=function(t,e){return Favorites.jsData.button_options.include_count?t+=' <span class="simplefavorite-button-count">'+(e=e<=0?0:e)+"</span>":t},this.decrementAllCounts=function(){for(var t=i(".simplefavorite-button.active.has-count"),e=0;e<t.length;e++){var o=i(t)[e],a=i(o).find(".simplefavorite-button-count"),a=i(a).text()-1;i(o).attr("data-favoritecount",a)}}},(Favorites=Favorites||{}).ButtonOptionsFormatter=function(){var s=this,n=jQuery;s.options=Favorites.jsData.button_options,s.formatter=new Favorites.Formatter,s.format=function(t,e){s.options.custom_colors&&s.colors(t,e),s.html(t,e)},s.html=function(t,e){var o=n(t).attr("data-favoritecount"),a=s.options.button_type,i="";return"custom"===s.options.button_type?(e&&n(t).html(s.formatter.addFavoriteCount(Favorites.jsData.favorited,o)),e||n(t).html(s.formatter.addFavoriteCount(Favorites.jsData.favorite,o)),s.applyIconColor(t,e),void s.applyCountColor(t,e)):e?(i+='<i class="'+a.icon_class+'"></i> ',i+=a.state_active,void n(t).html(s.formatter.addFavoriteCount(i,o))):(i+='<i class="'+a.icon_class+'"></i> ',i+=a.state_default,n(t).html(s.formatter.addFavoriteCount(i,o)),s.applyIconColor(t,e),void s.applyCountColor(t,e))},s.colors=function(t,e){if(s.options.custom_colors){var o;if(e)return(o=s.options.active).background_active&&n(t).css("background-color",o.background_active),o.border_active&&n(t).css("border-color",o.border_active),void(o.text_active&&n(t).css("color",o.text_active));(o=s.options.default).background_default&&n(t).css("background-color",o.background_default),o.border_default&&n(t).css("border-color",o.border_default),o.text_default&&n(t).css("color",o.text_default),s.boxShadow(t)}},s.boxShadow=function(t){s.options.box_shadow||(n(t).css("box-shadow","none"),n(t).css("-webkit-box-shadow","none"),n(t).css("-moz-box-shadow","none"))},s.applyIconColor=function(t,e){s.options.custom_colors&&(e&&s.options.active.icon_active&&n(t).find("i").css("color",s.options.active.icon_active),!e&&s.options.default.icon_default&&n(t).find("i").css("color",s.options.default.icon_default))},s.applyCountColor=function(t,e){s.options.custom_colors&&(e&&s.options.active.count_active?n(t).find(Favorites.selectors.count).css("color",s.options.active.count_active):!e&&s.options.default.count_default&&n(t).find(Favorites.selectors.count).css("color",s.options.default.count_default))}},(Favorites=Favorites||{}).UserFavorites=function(){var e=this,o=jQuery;return e.initialLoad=!1,e.bindEvents=function(){o(window).on("load",function(){e.initialLoad=!0,e.getFavorites()})},e.getFavorites=function(){o.ajax({url:Favorites.jsData.ajaxurl,type:"POST",datatype:"json",data:{action:Favorites.formActions.favoritesarray},success:function(t){Favorites.jsData.dev_mode&&(console.log("The current user favorites were successfully loaded."),console.log(t)),Favorites.userFavorites=t.favorites,o(document).trigger("favorites-user-favorites-loaded",[t.favorites,e.initialLoad]),o(document).trigger("favorites-update-all-buttons"),e.initialLoad&&favorites_after_initial_load(Favorites.userFavorites)},error:function(t){Favorites.jsData.dev_mode&&(console.log("The was an error loading the user favorites."),console.log(t))}})},e.bindEvents()},(Favorites=Favorites||{}).Clear=function(){var i=this,s=jQuery;return i.activeButton,i.utilities=new Favorites.Utilities,i.formatter=new Favorites.Formatter,i.bindEvents=function(){s(document).on("click",Favorites.selectors.clear_button,function(t){t.preventDefault(),i.activeButton=s(this),i.clearFavorites()}),s(document).on("favorites-updated-single",function(){i.updateClearButtons()}),s(document).on("favorites-user-favorites-loaded",function(){i.updateClearButtons()})},i.clearFavorites=function(){i.loading(!0);var e=s(i.activeButton).attr("data-siteid");s.ajax({url:Favorites.jsData.ajaxurl,type:"post",datatype:"json",data:{action:Favorites.formActions.clearall,siteid:e},success:function(t){Favorites.jsData.dev_mode&&(console.log("Favorites list successfully cleared."),console.log(t)),Favorites.userFavorites=t.favorites,i.formatter.decrementAllCounts(),i.loading(!1),i.clearSiteFavorites(e),s(document).trigger("favorites-cleared",[i.activeButton,t.old_favorites]),s(document).trigger("favorites-update-all-buttons")},error:function(t){Favorites.jsData.dev_mode&&(console.log("There was an error clearing the favorites list."),console.log(t))}})},i.loading=function(t){if(t)return s(i.activeButton).addClass(Favorites.cssClasses.loading),void s(i.activeButton).attr("disabled","disabled");s(i.activeButton).removeClass(Favorites.cssClasses.loading)},i.updateClearButtons=function(){for(var t=0;t<s(Favorites.selectors.clear_button).length;t++)for(var e=s(Favorites.selectors.clear_button)[t],o=s(e).attr("data-siteid"),a=0;a<Favorites.userFavorites.length;a++)Favorites.userFavorites[a].site_id===parseInt(o)&&(0<i.utilities.objectLength(Favorites.userFavorites[a].posts)?s(e).attr("disabled",!1):s(e).attr("disabled","disabled"))},i.clearSiteFavorites=function(o){s.each(Favorites.userFavorites,function(t,e){this.site_id===parseInt(o)&&(Favorites.userFavorites[t].posts={})})},i.bindEvents()},(Favorites=Favorites||{}).Lists=function(){var u=this,v=jQuery;return u.utilities=new Favorites.Utilities,u.buttonFormatter=new Favorites.ButtonOptionsFormatter,u.bindEvents=function(){v(document).on("favorites-update-all-lists",function(){u.updateAllLists()}),v(document).on("favorites-updated-single",function(){u.updateAllLists()}),v(document).on("favorites-cleared",function(){u.updateAllLists()}),v(document).on("favorites-user-favorites-loaded",function(){u.updateAllLists()})},u.updateAllLists=function(){if(void 0!==Favorites.userFavorites)for(var t=0;t<Favorites.userFavorites.length;t++)for(var e=v(Favorites.selectors.list+'[data-siteid="'+Favorites.userFavorites[t].site_id+'"]'),o=0;o<v(e).length;o++){var a=v(e)[o];u.updateSingleList(a)}},u.updateSingleList=function(e){var t=v(e).attr("data-userid"),o=v(e).attr("data-siteid"),a=v(e).attr("data-includelinks"),i=v(e).attr("data-includebuttons"),s=v(e).attr("data-includethumbnails"),n=v(e).attr("data-thumbnailsize"),r=v(e).attr("data-includeexcerpts"),c=v(e).attr("data-posttypes"),d=v(e).attr("data-nofavoritestext");v.ajax({url:Favorites.jsData.ajaxurl,type:"post",dataType:"json",data:{action:Favorites.formActions.favoritelist,userid:t,siteid:o,include_links:a,include_buttons:i,include_thumbnails:s,thumbnail_size:n,include_excerpt:r,no_favorites:d,post_types:c},success:function(t){Favorites.jsData.dev_mode&&(console.log("Favorites list successfully retrieved."),console.log(v(e)),console.log(t));t=v(t.list);v(e).replaceWith(t),u.removeButtonLoading(t),v(document).trigger("favorites-list-updated",[t])},error:function(t){Favorites.jsData.dev_mode&&(console.log("There was an error updating the list."),console.log(e),console.log(t))}})},u.removeButtonLoading=function(t){t=v(t).find(Favorites.selectors.button);v.each(t,function(){u.buttonFormatter.format(v(this),!1),v(this).removeClass(Favorites.cssClasses.active),v(this).removeClass(Favorites.cssClasses.loading)})},u.removeInvalidListItems=function(t,a){t=v(t).find("li[data-postid]");v.each(t,function(t,e){var o=v(this).attr("data-postid");u.utilities.isFavorite(o,a)||v(this).remove()})},u.bindEvents()},(Favorites=Favorites||{}).Button=function(){var o=this,a=jQuery;return o.activeButton,o.allButtons,o.authenticated=!0,o.formatter=new Favorites.Formatter,o.data={},o.bindEvents=function(){a(document).on("click",Favorites.selectors.button,function(t){t.preventDefault(),o.activeButton=a(this),o.setAllButtons(),o.submitFavorite()})},o.setAllButtons=function(){var t=a(o.activeButton).attr("data-postid"),e=a(o.activeButton).attr("data-elementtype");o.allButtons=a(e+'[data-postid="'+t+'"]')},o.setData=function(){o.data.post_id=a(o.activeButton).attr("data-postid"),o.data.site_id=a(o.activeButton).attr("data-siteid"),o.data.status=a(o.activeButton).hasClass("active")?"inactive":"active";var t=a(o.activeButton).attr("data-user-consent-accepted");o.data.user_consent_accepted=void 0!==t&&""!==t},o.submitFavorite=function(){o.loading(!0),o.setData();var t={action:Favorites.formActions.favorite,postid:o.data.post_id,siteid:o.data.site_id,status:o.data.status,user_consent_accepted:o.data.user_consent_accepted};a.ajax({url:Favorites.jsData.ajaxurl,type:"post",dataType:"json",data:t,success:function(t){return Favorites.jsData.dev_mode&&(console.log("The favorite was successfully saved."),console.log(t)),"unauthenticated"===t.status?(Favorites.authenticated=!1,o.loading(!1),o.data.status="inactive",a(document).trigger("favorites-update-all-buttons"),void a(document).trigger("favorites-require-authentication",[o.data])):"consent_required"===t.status?(o.loading(!1),void a(document).trigger("favorites-require-consent",[t,o.data,o.activeButton])):(Favorites.userFavorites=t.favorites,o.loading(!1),o.resetButtons(),a(document).trigger("favorites-updated-single",[t.favorites,o.data.post_id,o.data.site_id,o.data.status]),a(document).trigger("favorites-update-all-buttons"),void favorites_after_button_submit(t.favorites,o.data.post_id,o.data.site_id,o.data.status))},error:function(t){Favorites.jsData.dev_mode&&(console.log("There was an error saving the favorite."),console.log(t))}})},o.resetButtons=function(){var t=parseInt(a(o.activeButton).attr("data-favoritecount"));a.each(o.allButtons,function(){return"inactive"===o.data.status?(t<=0&&(t=1),a(this).removeClass(Favorites.cssClasses.active),a(this).attr("data-favoritecount",t-1),void a(this).find(Favorites.selectors.count).text(t-1)):(a(this).addClass(Favorites.cssClasses.active),a(this).attr("data-favoritecount",t+1),void a(this).find(Favorites.selectors.count).text(t+1))})},o.loading=function(t){t?a.each(o.allButtons,function(){a(this).attr("disabled","disabled"),a(this).addClass(Favorites.cssClasses.loading),a(this).html(o.addLoadingIndication())}):a.each(o.allButtons,function(){a(this).attr("disabled",!1),a(this).removeClass(Favorites.cssClasses.loading)})},o.addLoadingIndication=function(t){return"1"!==Favorites.jsData.indicate_loading?t:"active"===o.data.status?Favorites.jsData.loading_text+Favorites.jsData.loading_image_active:Favorites.jsData.loading_text+Favorites.jsData.loading_image},o.bindEvents()},(Favorites=Favorites||{}).ButtonUpdater=function(){var a=this,i=jQuery;return a.utilities=new Favorites.Utilities,a.formatter=new Favorites.Formatter,a.buttonFormatter=new Favorites.ButtonOptionsFormatter,a.activeButton,a.data={},a.bindEvents=function(){i(document).on("favorites-update-all-buttons",function(){a.updateAllButtons()}),i(document).on("favorites-list-updated",function(t,e){a.updateAllButtons(e)})},a.updateAllButtons=function(t){if(void 0!==Favorites.userFavorites)for(var e=i(Favorites.selectors.button),o=0;o<i(e).length;o++)a.activeButton=i(e)[o],Favorites.authenticated&&a.setButtonData(),Favorites.authenticated&&a.utilities.isFavorite(a.data.postid,a.data.site_favorites)?(a.buttonFormatter.format(i(a.activeButton),!0),i(a.activeButton).addClass(Favorites.cssClasses.active)):(a.buttonFormatter.format(i(a.activeButton),!1),i(a.activeButton).removeClass(Favorites.cssClasses.active)),i(a.activeButton).removeClass(Favorites.cssClasses.loading),i(a.activeButton).find(Favorites.selectors.count).text(a.data.favorite_count)},a.setButtonData=function(){a.data.postid=i(a.activeButton).attr("data-postid"),a.data.siteid=i(a.activeButton).attr("data-siteid"),a.data.favorite_count=i(a.activeButton).attr("data-favoritecount"),a.data.site_index=a.utilities.siteIndex(a.data.siteid),a.data.site_favorites=Favorites.userFavorites[a.data.site_index].posts,a.data.favorite_count<=0&&(a.data.favorite_count=0)},a.bindEvents()},(Favorites=Favorites||{}).TotalCount=function(){var t=this,r=jQuery;return t.bindEvents=function(){r(document).on("favorites-updated-single",function(){t.updateTotal()}),r(document).on("favorites-cleared",function(){t.updateTotal()}),r(document).on("favorites-user-favorites-loaded",function(){t.updateTotal()})},t.updateTotal=function(){for(var t=0;t<r(Favorites.selectors.total_favorites).length;t++){for(var e=r(Favorites.selectors.total_favorites)[t],o=parseInt(r(e).attr("data-siteid")),a=r(e).attr("data-posttypes").split(","),i=0,s=0;s<Favorites.userFavorites.length;s++){var n=Favorites.userFavorites[s];n.site_id===o&&r.each(n.posts,function(){("all"===r(e).attr("data-posttypes")||-1!==r.inArray(this.post_type,a))&&i++})}r(e).text(i)}},t.bindEvents()},(Favorites=Favorites||{}).PostFavoriteCount=function(){var s=this,c=jQuery;return s.bindEvents=function(){c(document).on("favorites-updated-single",function(t,e,o,a,i){return"active"===i?s.updateCounts():void s.decrementSingle(o,a)}),c(document).on("favorites-cleared",function(t,e,o){s.updateCounts(o,!0)})},s.updateCounts=function(t,e){void 0!==t&&""!==t||(t=Favorites.userFavorites),void 0!==e&&""!==e||(e=!1);for(var o=0;o<c("["+Favorites.selectors.post_favorite_count+"]").length;o++){var a=c("["+Favorites.selectors.post_favorite_count+"]")[o],i=parseInt(c(a).attr(Favorites.selectors.post_favorite_count)),s=c(a).attr("data-siteid");""===s&&(s="1");for(var n=0;n<t.length;n++){var r=t[n];r.site_id===parseInt(s)&&c.each(r.posts,function(){var t;this.post_id===i&&(e?(t=parseInt(this.total)-1,c(a).text(t)):c(a).text(this.total))})}}},s.decrementSingle=function(t,e){for(var o=0;o<c("["+Favorites.selectors.post_favorite_count+"]").length;o++){var a=c("["+Favorites.selectors.post_favorite_count+"]")[o],i=c(a).attr(Favorites.selectors.post_favorite_count),s=c(a).attr("data-siteid");(s=""===s?"1":s)===e&&i===t&&(i=parseInt(c(a).text())-1,c(a).text(i))}},s.bindEvents()},(Favorites=Favorites||{}).RequireAuthentication=function(){var e=this,o=jQuery;return e.bindEvents=function(){o(document).on("favorites-require-authentication",function(){Favorites.jsData.dev_mode&&console.log("Unauthenticated user was prevented from favoriting."),Favorites.jsData.authentication_redirect?e.redirect():e.openModal()}),o(document).on("click",".simplefavorites-modal-backdrop",function(t){e.closeModal()}),o(document).on("click","["+Favorites.selectors.close_modals+"]",function(t){t.preventDefault(),e.closeModal()})},e.redirect=function(){window.location=Favorites.jsData.authentication_redirect_url},e.openModal=function(){e.buildModal(),setTimeout(function(){o("["+Favorites.selectors.modals+"]").addClass("active")},10)},e.buildModal=function(){var t;0<o("["+Favorites.selectors.modals+"]").length||(t='<div class="simplefavorites-modal-backdrop" '+Favorites.selectors.modals+"></div>",t+='<div class="simplefavorites-modal-content" '+Favorites.selectors.modals+">",t+='<div class="simplefavorites-modal-content-body">',t+=Favorites.jsData.authentication_modal_content,t+="</div>\x3c!-- .simplefavorites-modal-content-body --\x3e",t+="</div>\x3c!-- .simplefavorites-modal-content --\x3e",o("body").prepend(t))},e.closeModal=function(){o("["+Favorites.selectors.modals+"]").removeClass("active"),o(document).trigger("favorites-modal-closed")},e.bindEvents()},(Favorites=Favorites||{}).RequireConsent=function(){var i=this,o=jQuery;return i.consentData,i.postData,i.activeButton,i.bindEvents=function(){o(document).on("favorites-require-consent",function(t,e,o,a){i.consentData=e,i.postData=o,i.activeButton=a,i.openModal()}),o(document).on("favorites-user-consent-approved",function(t,e){return void 0!==e?(o(i.activeButton).attr("data-user-consent-accepted","true"),o(i.activeButton).click(),void i.closeModal()):void i.setConsent(!0)}),o(document).on("favorites-user-consent-denied",function(){i.setConsent(!1)}),o(document).on("click",".simplefavorites-modal-backdrop",function(t){i.closeModal()}),o(document).on("click","[data-favorites-consent-deny]",function(t){t.preventDefault(),i.closeModal(),o(document).trigger("favorites-user-consent-denied")}),o(document).on("click","[data-favorites-consent-accept]",function(t){t.preventDefault(),o(document).trigger("favorites-user-consent-approved",[o(this)])})},i.openModal=function(){i.buildModal(),setTimeout(function(){o("["+Favorites.selectors.consentModal+"]").addClass("active")},10)},i.buildModal=function(){var t;0<o("["+Favorites.selectors.consentModal+"]").length||(t='<div class="simplefavorites-modal-backdrop" '+Favorites.selectors.consentModal+"></div>",t+='<div class="simplefavorites-modal-content" '+Favorites.selectors.consentModal+">",t+='<div class="simplefavorites-modal-content-body no-padding">',t+='<div class="simplefavorites-modal-content-interior">',t+=i.consentData.message,t+="</div>",t+='<div class="simplefavorites-modal-content-footer">',t+='<button class="simplefavorites-button-consent-deny" data-favorites-consent-deny>'+i.consentData.deny_text+"</button>",t+='<button class="simplefavorites-button-consent-accept" data-favorites-consent-accept>'+i.consentData.accept_text+"</button>",t+="</div>\x3c!-- .simplefavorites-modal-footer --\x3e",t+="</div>\x3c!-- .simplefavorites-modal-content-body --\x3e",t+="</div>\x3c!-- .simplefavorites-modal-content --\x3e",o("body").prepend(t))},i.closeModal=function(){o("["+Favorites.selectors.consentModal+"]").removeClass("active")},i.setConsent=function(t){o.ajax({url:Favorites.jsData.ajaxurl,type:"post",dataType:"json",data:{action:Favorites.formActions.cookieConsent,consent:t}})},i.bindEvents()},jQuery(document).ready(function(){new Favorites.Factory}),(Favorites=Favorites||{}).selectors={button:".simplefavorite-button",list:".favorites-list",clear_button:".simplefavorites-clear",total_favorites:".simplefavorites-user-count",modals:"data-favorites-modal",consentModal:"data-favorites-consent-modal",close_modals:"data-favorites-modal-close",count:".simplefavorite-button-count",post_favorite_count:"data-favorites-post-count-id"},Favorites.cssClasses={loading:"loading",active:"active"},Favorites.jsData={ajaxurl:favorites_data.ajaxurl,favorite:favorites_data.favorite,favorited:favorites_data.favorited,include_count:favorites_data.includecount,indicate_loading:favorites_data.indicate_loading,loading_text:favorites_data.loading_text,loading_image_active:favorites_data.loading_image_active,loading_image:favorites_data.loading_image,cache_enabled:favorites_data.cache_enabled,authentication_modal_content:favorites_data.authentication_modal_content,authentication_redirect:favorites_data.authentication_redirect,authentication_redirect_url:favorites_data.authentication_redirect_url,button_options:favorites_data.button_options,dev_mode:favorites_data.dev_mode,logged_in:favorites_data.logged_in,user_id:favorites_data.user_id},Favorites.userFavorites=null,Favorites.authenticated=!0,Favorites.formActions={favoritesarray:"favorites_array",favorite:"favorites_favorite",clearall:"favorites_clear",favoritelist:"favorites_list",cookieConsent:"favorites_cookie_consent"},Favorites.Factory=function(){jQuery;return this.build=function(){new Favorites.UserFavorites,new Favorites.Lists,new Favorites.Clear,new Favorites.Button,new Favorites.ButtonUpdater,new Favorites.TotalCount,new Favorites.PostFavoriteCount,new Favorites.RequireAuthentication,new Favorites.RequireConsent},this.build()};